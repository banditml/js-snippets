function BanditAPI(t){this.contextName="banditMLContext",this.storage=window.localStorage,this.banditApikey=t;this.banditDecisionEndpoint="http://localhost:8000/api/decision",this.banditLogRewardEndpoint="http://localhost:8000/api/reward",this.ipUrl="https://api.ipify.org?format=json"}BanditAPI.prototype.assert=function(t,e){if(!1===t)throw e},BanditAPI.prototype.asyncGetRequest=async function(t,e=null,n=null,i={}){if(null!=e&&null!=n){t+=`?${e}=`+encodeURIComponent(JSON.stringify(n))}const o=await fetch(t,{method:"GET",headers:i});return await o.json()},BanditAPI.prototype.asyncPostRequest=async function(t="",e={},n={}){e.hasOwnProperty("Content-Type")||(e["Content-Type"]="application/json");const i=await fetch(t,{method:"POST",headers:e,body:JSON.stringify(n)});return await i.json()},BanditAPI.prototype.getContext=function(){return JSON.parse(this.storage.getItem(this.contextName))},BanditAPI.prototype.setContext=function(t){this.storage.setItem(this.contextName,JSON.stringify(t))},BanditAPI.prototype.clearContext=function(){this.storage.removeItem(this.contextName)},BanditAPI.prototype.updateContextList=function(t){const e=this;Object.keys(t).forEach(function(n){e.assert(Array.isArray(t[n]),`Key "${n}" is not an array.`)});let n=e.getContext();null==n?n=t:Object.keys(t).forEach(function(e){e in n?n[e].push(...t[e]):n[e]=t[e]}),e.setContext(n)},BanditAPI.prototype.updateContextValue=function(t){let e=this.getContext();e=null==e?t:Object.assign({},e,t),this.setContext(e)},BanditAPI.prototype.getDecision=function(t){this.asyncGetRequest(this.ipUrl).then(t=>t).then(t=>{this.updateContextValue({ip:t.ip})});let e=this.getContext();return this.asyncGetRequest(url=this.banditDecisionEndpoint,paramName="context",body=e,headers={Authorization:`ApiKey ${this.banditApikey}`}).then(t=>t).catch(function(t){return console.error(t),{message:"Decision request failed."}})},BanditAPI.prototype.logReward=function(t,e){const n={Authorization:`ApiKey ${this.banditApikey}`};this.asyncPostRequest(this.banditLogRewardEndpoint,n,{decisionId:t,reward:e}).then(t=>t)};
